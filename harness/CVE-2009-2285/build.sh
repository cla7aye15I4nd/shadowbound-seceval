#!/bin/bash

if [ ! -d "tiff-3.8.2" ]; then
	tar -xvf tiff-3.8.2.tar.gz
fi

pushd tiff-3.8.2


CC=$SHADOWBOUND/llvm-project/build/bin/clang \
CXX=$SHADOWBOUND/llvm-project/build/bin/clang++ \
CFLAGS="-fsanitize=overflow-defense" \
CXXFLAGS="-fsanitize=overflow-defense" \
./configure --disable-shared

make -j`nproc`

popd

# ./tiff-3.8.2/tools/tiff2ps libtiff_crash/wololo.tif
