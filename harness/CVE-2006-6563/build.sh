#!/bin/bash

if [ ! -d "proftpd-1.3.0a" ]; then
	tar -xvf proftpd-1.3.0a.tar.gz
fi

pushd proftpd-1.3.0a


CC=$SHADOWBOUND/llvm-project/build/bin/clang \
CXX=$SHADOWBOUND/llvm-project/build/bin/clang++ \
CFLAGS="-fsanitize=overflow-defense" \
CXXFLAGS="-fsanitize=overflow-defense" \
LDFLAGS="-fsanitize=overflow-defense" \
./configure --disable-shared

make -j`nproc`

popd

# ./tiff-3.8.2/tools/tiff2ps libtiff_crash/wololo.tif

sudo ./proftpd-1.3.0a/proftpd -n
sudo perl 3330.pl /usr/local/var/proftpd/proftpd.sock 1
sudo perl 3333.pl /usr/local/var/proftpd/proftpd.sock 1
python 2928.py