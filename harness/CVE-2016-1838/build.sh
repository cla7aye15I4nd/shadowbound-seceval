#!/bin/bash

if [ ! -d "libxml2" ]; then
	git clone https://gitlab.gnome.org/GNOME/libxml2.git -b v2.9.3
fi

pushd libxml2


CC=$SHADOWBOUND/llvm-project/build/bin/clang \
CXX=$SHADOWBOUND/llvm-project/build/bin/clang++ \
CFLAGS="-fsanitize=overflow-defense" \
CXXFLAGS="-fsanitize=overflow-defense" \
./autogen.sh  \
	--with-http=no \
	--with-python=no \
	--with-lzma=yes \
	--with-threads=no \
	--disable-shared

make 

popd